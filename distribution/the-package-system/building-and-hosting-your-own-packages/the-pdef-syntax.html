

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The pdef syntax &mdash; Panda3D Manual</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Panda3D Manual" href="../../../index.html"/>
        <link rel="up" title="Building and hosting your own packages" href="index.html"/>
        <link rel="next" title="Creating multiple packages" href="creating-multiple-packages.html"/>
        <link rel="prev" title="Using ppackage" href="using-ppackage.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Panda3D
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro/index.html">Introduction to Panda3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programming-with-panda3d/index.html">Programming with Panda3D</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Distributing Panda3D Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction-to-p3d-files/index.html">Introduction to p3d files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../distributing-via-the-web/index.html">Distributing via the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../p3d-file-config-settings.html">P3D file config settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../distributing-as-a-self-contained-installer.html">Distributing as a self-contained installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the-runtime-panda3d-directory.html">The runtime Panda3D directory</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">The package system</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-packages.html">Standard packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-packages.html">Installing packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../more-about-referencing-packages.html">More about referencing packages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Building and hosting your own packages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="using-ppackage.html">Using ppackage</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">The pdef syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="creating-multiple-packages.html">Creating multiple packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="hosting-packages.html">Hosting packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="ssl-hosting.html">SSL hosting</a></li>
<li class="toctree-l4"><a class="reference internal" href="building-multiplatform-packages.html">Building multiplatform packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="building-patches.html">Building patches</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-scripting-techniques/index.html">Advanced scripting techniques</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples/index.html">Sample Programs in the Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance-tuning/index.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../using-c++/index.html">Using C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Panda3D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building-from-source.html">Building Panda3D from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cheat-sheets.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started-on-osx.html">Getting Started on OSX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../more-panda3d-resources.html">More Panda3D Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../thirdparty-licenses.html">Third-party dependencies and license info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-irc-channel.html">The IRC Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Panda3D</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Distributing Panda3D Applications</a> &raquo;</li>
      
          <li><a href="../index.html">The package system</a> &raquo;</li>
      
          <li><a href="index.html">Building and hosting your own packages</a> &raquo;</li>
      
    <li>The pdef syntax</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/distribution/the-package-system/building-and-hosting-your-own-packages/the-pdef-syntax.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-pdef-syntax">
<span id="id1"></span><h1>The pdef syntax<a class="headerlink" href="#the-pdef-syntax" title="Permalink to this headline">Â¶</a></h1>
<p>A package definition looks something like a Python class definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">mypackage</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
    <span class="nb">file</span><span class="p">(</span><span class="s1">&#39;neededfile.dll&#39;</span><span class="p">)</span>
    <span class="n">module</span><span class="p">(</span><span class="s1">&#39;my.python.module&#39;</span><span class="p">)</span>
    <span class="nb">dir</span><span class="p">(</span><span class="s1">&#39;/c/my/root_dir&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In fact, you can put any Python syntax you like into a pdef file, and it will
be executed by ppackage. A pdef file is really just a special kind of Python
program. The class syntax shown above is just the convention by which packages
are declared.</p>
<p>The above sample generates a package called &#8220;mypackage&#8221;, which contains the
file neededfile.dll and the Python module my/python/module.py, as well as all
files that those two files reference in turn; it also includes all of the
contents of c:\my\root_dir .</p>
<p>More details of the pdef syntax will be provided soon. In the meantime, you
can also examine the file direct/src/p3d/panda3d.pdef, for a sample file that
produces the panda3d package itself (as well as some related packages).</p>
<p>You can also examine the file direct/src/p3d/Packager.py; any method of
Packager named do_foo() produces a package function you can call named foo().
For instance, there is a Packager.do_file() method that accepts a Filename
(as well as other optional parameters); this method is called when file()
appears within a class definition in a pdef file.</p>
<p>Sometimes the files and modules you wish to include are not on the path, and
thus can not be found. To see what is on the path is when your pdef file is
run, you can use this at the top of your pdef file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
<p>Often when building packages, it&#8217;s useful to have the working directory on the
path, but it may be missing. It can be added with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1">#add the working directory as the first entry in sys.path</span>
</pre></div>
</div>
<p>When making p3d packages, you use p3d instead of package for the class. An
example p3d could be as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># add the working directory to the path so local files and modules can be found</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyP3D</span><span class="p">(</span><span class="n">p3d</span><span class="p">):</span>
    <span class="n">require</span><span class="p">(</span><span class="s1">&#39;morepy&#39;</span><span class="p">,</span><span class="s1">&#39;panda3d&#39;</span><span class="p">,</span><span class="s1">&#39;somePackage&#39;</span><span class="p">)</span> <span class="c1"># include some other packages</span>

    <span class="n">config</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
        <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;MyP3D&quot;</span><span class="p">)</span>

    <span class="n">module</span><span class="p">(</span><span class="s1">&#39;core.*&#39;</span><span class="p">)</span> <span class="c1"># include the python package core, and its submodules</span>
    <span class="nb">dir</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">newDir</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span> <span class="c1"># include a folder called data</span>
    <span class="n">mainModule</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">)</span> <span class="c1"># include and set the main module that runs when the p3d is run</span>
    <span class="nb">file</span><span class="p">(</span><span class="s1">&#39;events.txt&#39;</span><span class="p">)</span> <span class="c1"># include a text file</span>
</pre></div>
</div>
<p>Generally what ppackage is pretty good about finding what modules are imported
and automatically including them, but there are cases where this fails and
explicitly specifying something like &#8220;module(&#8216;api.*.*&#8217;)&#8221; is useful.</p>
<p>As of Panda3D 1.7.1, you can specify an optional &#8216;required&#8217; parameter to the
file() or module() function call. By setting it to true, you can indicate that
this file is vital to the package. Basically, when the file is missing and the
required flag is set, it will refuse to build the package (rather than just
emitting a warning).</p>
<p>You can put loops, if statements (based on os.name for example) and other flow
control inside packages, but calling functions outside of them that add files
and modules and such will not work.</p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="creating-multiple-packages.html" class="btn btn-neutral float-right" title="Creating multiple packages" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="using-ppackage.html" class="btn btn-neutral" title="Using ppackage" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Panda3D.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.10.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>