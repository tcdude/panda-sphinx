

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>More about GeomVertexReader, GeomVertexWriter, and GeomVertexRewriter &mdash; Panda3D Manual</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Panda3D Manual" href="../../../index.html"/>
        <link rel="up" title="Other Vertex and Model Manipulation" href="index.html"/>
        <link rel="next" title="Creating New Textures from Scratch" href="creating-new-textures-from-scratch.html"/>
        <link rel="prev" title="MeshDrawer" href="meshdrawer.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Panda3D
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro/index.html">Introduction to Panda3D</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Programming with Panda3D</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../the-scene-graph/index.html">The Scene Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the-configuration-file/index.html">The Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models-and-actors/index.html">Models and Actors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../render-attributes/index.html">Render Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../texturing/index.html">Texturing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../shaders/index.html">Shaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../camera-control/index.html">Camera Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sound/index.html">Sound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intervals/index.html">Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tasks-and-event-handling/index.html">Tasks and Event Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../text-and-image-rendering/index.html">Text and Image Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../directgui/index.html">DirectGUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../render-effects/index.html">Render Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../finite-state-machines/index.html">Finite State Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../terrain/index.html">Terrain</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Advanced operations with Panda3D&#8217;s internal structures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../how-panda3d-stores-vertices-and-geometry/index.html">How Panda3D Stores Vertices and Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedural-generation/index.html">Procedurally Generating 3D Models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Other Vertex and Model Manipulation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="reading-existing-geometry-data.html">Reading existing geometry data</a></li>
<li class="toctree-l4"><a class="reference internal" href="modifying-existing-geometry-data.html">Modifying existing geometry data</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshdrawer.html">MeshDrawer</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">More about GeomVertexReader, GeomVertexWriter, and GeomVertexRewriter</a></li>
<li class="toctree-l4"><a class="reference internal" href="creating-new-textures-from-scratch.html">Creating New Textures from Scratch</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing-3d-models-out-to-disk.html">Writing 3D Models out to Disk</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../render-to-texture-and-image-postprocessing/index.html">Render-to-Texture and Image Postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../panda3d-rendering-process/index.html">Panda3D Rendering Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../panda3d-utility-functions.html">Panda3D Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../particle-effects/index.html">Particle Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../collision-detection/index.html">Collision Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../garbage-collection/index.html">Garbage Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware-support/index.html">Hardware support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math-engine/index.html">Math Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../physics/index.html">Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../motion-paths.html">Motion Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../timing/index.html">Timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multifiles/index.html">Multifiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../showbase.html">ShowBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file-reading.html">File Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../threading.html">Threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subclassing.html">Subclassing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../table-of-features-supported-per-graphic-renderer.html">Table of features supported per graphic renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pandai/index.html">Artificial Intelligence (PANDAI)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../distribution/index.html">Distributing Panda3D Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples/index.html">Sample Programs in the Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance-tuning/index.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../using-c++/index.html">Using C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Panda3D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building-from-source.html">Building Panda3D from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cheat-sheets.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started-on-osx.html">Getting Started on OSX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../more-panda3d-resources.html">More Panda3D Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../thirdparty-licenses.html">Third-party dependencies and license info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-irc-channel.html">The IRC Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Panda3D</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Programming with Panda3D</a> &raquo;</li>
      
          <li><a href="../index.html">Advanced operations with Panda3D&#8217;s internal structures</a> &raquo;</li>
      
          <li><a href="index.html">Other Vertex and Model Manipulation</a> &raquo;</li>
      
    <li>More about GeomVertexReader, GeomVertexWriter, and GeomVertexRewriter</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/programming-with-panda3d/internal-structures/other-vertex-and-model-manipulation/more-about-geomvertexreader-geomvertexwriter-and-geomvertexrewriter.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="more-about-geomvertexreader-geomvertexwriter-and-geomvertexrewriter">
<span id="id1"></span><h1>More about GeomVertexReader, GeomVertexWriter, and GeomVertexRewriter<a class="headerlink" href="#more-about-geomvertexreader-geomvertexwriter-and-geomvertexrewriter" title="Permalink to this headline">¶</a></h1>
<p>The classes GeomVertexReader and GeomVertexWriter together represent the core
interface for reading and writing the numeric data stored within a
<a class="reference internal" href="../how-panda3d-stores-vertices-and-geometry/geomvertexdata.html#geomvertexdata"><span class="std std-ref">GeomVertexData</span></a> object.</p>
<p>These two classes work similarly. Both are designed to get a temporary pointer
to the data for a particular column when they are constructed, and they
increment that pointer as you walk through the vertices. Initially, they start
at row number 0 (the first vertex in the table), and after each
setData/getData operation, they automatically increment to the next row (the
next vertex).</p>
<p>You construct a GeomVertexReader or GeomVertexWriter with a pointer to the
<a class="reference internal" href="../how-panda3d-stores-vertices-and-geometry/geomvertexdata.html#geomvertexdata"><span class="std std-ref">GeomVertexData</span></a> object you are operating on, and the name of the column
you wish to process, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">GeomVertexReader</span><span class="p">(</span><span class="n">vdata</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Because the GeomVertexReader and GeomVertexWriter classes only store a
temporary pointer, which might become invalid between frames or even between
different tasks within a frame, these objects should not be stored in any
persistent object. Instead, they are designed to be temporary objects that are
constructed locally, used immediately to iterate through a list of vertices,
and then released. If you need to keep a persistent iterator for your vertex
data, to be used over a long period of time (e.g. over several frames), then
you should store just the GeomVertexData pointer (along with the current
vertex index number if you require this), and construct a temporary
GeomVertexReader/Writer each time you need to access it.</p>
<p>The following methods are available to read and write data in a column:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>GeomVertexReader</strong></td>
<td><strong>GeomVertexWriter</strong></td>
</tr>
<tr class="row-even"><td>x = getData1f()</td>
<td>setData1f(x)addData1f(x)</td>
</tr>
<tr class="row-odd"><td>v2 = getData2f()</td>
<td>setData2f(x, y)setData2f(v2)addData2f(x, y)addData2f(v2)</td>
</tr>
<tr class="row-even"><td>v3 = getData3f()</td>
<td>setData3f(x, y, z)setData3f(v3)addData3f(x, y, z)addData3f(v3)</td>
</tr>
<tr class="row-odd"><td>v4 = getData4f()</td>
<td>setData4f(x, y, z, w)setData4f(v4)addData4f(x, y, z, w)addData4f(v4)</td>
</tr>
<tr class="row-even"><td>x = getData1i()</td>
<td>setData1i(x)addData1i(x)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>setData2i(x, y)addData2i(x, y)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>setData3i(x, y, z)addData3i(x, y, z)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>setData4i(x, y, z, w)addData4i(x, y, z, w)</td>
</tr>
</tbody>
</table>
<p>Each of the getData family of functions supported by GeomVertexReader returns
the value of the data in the current column, converted to the requested type.
The &#8216;f&#8217; suffix indicates a floating-point value, while &#8216;i&#8217; indicates an
integer value; the digit indicates the number of components you expect to
receive.</p>
<p>For instance, getData2f() always returns a VBase2, regardless of the type of
data actually stored in the column. If the column contains a 2-component value
such as a 2-D texture coordinate, then the returned value will represent the
(U, V) value in that column. However, if the column type does not match the
requested type, a conversion is quietly made; for instance, if you call
getData2f() but the column actually contains a 3-D texture coordinate, the
third component will be omitted from the return value, which will still be a
VBase2.</p>
<p>Similarly, the setData and addData family of functions supported by
GeomVertexWriter accept a value in the indicated format, and convert it to
whatever format is required by the column. So if you call setData3f(), and the
column has three components, you will set all three components with the x, y,
z parameters of setData3f(); but if the column has only two components, only
the x, y parameters will be used to set those two components, and the third
parameter will be ignored.</p>
<p>Certain kinds of numeric conversions are performed automatically, according to
the column&#8217;s designated contents. For instance, if you store a floating-point
value into an integer column, the fractional part of the value is usually
truncated. However, if the column contents indicates that it represents a
color value, then the floating-point value is automatically scaled from the
range 0.0 .. 1.0 into the full numeric range of the column&#8217;s integer value.
This allows you to store color components in the range 0.0 .. 1.0, and get the
expected result (that is, the value is scaled into the range 0 .. 255). A
similar conversion happens when data is read.</p>
<p>There are no getData2i, 3i, or 4i methods available, simply because Panda does
not currently define a multi-component integer value that can be returned to
Python. Since most multi-component column types are floating-point, or can be
expressed as floating-point, this is not generally a limitation.</p>
<p>Each GeomVertexReader keeps track of the current read row, which is initially
0; the current value can be retrieved by getReadRow(). Each call to a getData
function returns the value of the column at the current read row, and then
increments the current read row. It is an error to call getData when the read
row has reached the end of the data, but you can call isAtEnd(), which returns
true when the reader has reached the end. Thus, you can iterate through all
the rows of a vertex table by repeatedly calling getData until isAtEnd()
returns true.</p>
<p>Similarly, each GeomVertexWriter keeps track of the current write row, which
is initially 0, and can be retrieved by getWriteRow(). Each call to setData or
addData stores the given value in the current write row, and then increments
the current write row. It is an error to call setData when the write row has
reached the end of the data; but as with the GeomVertexReader, you can call
isAtEnd() to determine when you have reached the end of the data.</p>
<p>The addData family of functions work exactly like the setData functions,
except that addData can be called when the GeomVertexWriter has reached its
end. In this case, addData will add a new row to the table, and then fill in
the specified data in that row (and then increment the current write row). If
addData is called when the current write row already exists, it behaves
exactly the same as setData.</p>
<p>With either GeomVertexReader or GeomVertexWriter, you can set the current read
or write row at any time with the call setRow(). This sets the current read
row (GeomVertexReader) or current write row (GeomVertexWriter) to the
indicated value; the next call to getData or setData/addData will then operate
on the specified row, and increment from there.</p>
<div class="section" id="geomvertexrewriter">
<h2>GeomVertexRewriter<a class="headerlink" href="#geomvertexrewriter" title="Permalink to this headline">¶</a></h2>
<p>The GeomVertexRewriter class exists as a convenience for code that needs to
alternately read and write the data on a column. GeomVertexRewriter multiply
inherits from GeomVertexReader and GeomVertexWriter, so it supports the
getData family of functions, as well as the setData and addData family of
functions. It also has both a current read row and a current write row, which
might be different.</p>
<p>Normally, you would use a GeomVertexRewriter to walk through the list of
vertices from the beginning to end, reading and writing as it goes. For
instance, to set all of the Z components of a piece of geometry to 0.0, while
preserving the X and Y components, you might write a loop such as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">vertex</span> <span class="o">=</span> <span class="n">GeomVertexRewriter</span><span class="p">(</span><span class="n">vdata</span><span class="p">,</span> <span class="s1">&#39;vertex&#39;</span><span class="p">)</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">vertex</span><span class="o">.</span><span class="n">isAtEnd</span><span class="p">():</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">getData3f</span><span class="p">()</span>
  <span class="n">vertex</span><span class="o">.</span><span class="n">setData3f</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this example code calls getData3f() and setData3f() exactly once
through each iteration, which increments the current read row and current
write row, respectively; so the current read row and current write row are
kept in sync with each other.</p>
<p>Important! When you are simultaneously reading from and writing to the same
GeomVertexData object, you should create all of the GeomVertexWriters and
GeomVertexRewriters you need before you create any GeomVertexReader. This is
because of Panda&#8217;s internal referencing-counting mechanism; creating a
GeomVertexWriter may automatically (and transparently) force a copy of the
data in the GeomVertexData, which could invalidate any GeomVertexReaders you
have already created.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="creating-new-textures-from-scratch.html" class="btn btn-neutral float-right" title="Creating New Textures from Scratch" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="meshdrawer.html" class="btn btn-neutral" title="MeshDrawer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Panda3D.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.10.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>