

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Interrogate &mdash; Panda3D Manual</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Panda3D Manual" href="../index.html"/>
        <link rel="up" title="Panda3D Tools" href="index.html"/>
        <link rel="next" title="Pipeline Tips" href="pipeline-tips.html"/>
        <link rel="prev" title="Enhanced Mouse Navigation" href="the-scene-graph-browser/enhanced-mouse-navigation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Panda3D
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction to Panda3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-with-panda3d/index.html">Programming with Panda3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distribution/index.html">Distributing Panda3D Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">Sample Programs in the Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-tuning/index.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-c++/index.html">Using C++</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Panda3D Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="the-scene-graph-browser/index.html">The Scene Graph Browser</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Interrogate</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline-tips.html">Pipeline Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-export/index.html">Model Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="pview.html">Previewing 3D Models in Pview</a></li>
<li class="toctree-l2"><a class="reference internal" href="list-of-panda3d-executables.html">List of Panda3D Executables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../building-from-source.html">Building Panda3D from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat-sheets.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-on-osx.html">Getting Started on OSX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../more-panda3d-resources.html">More Panda3D Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thirdparty-licenses.html">Third-party dependencies and license info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-irc-channel.html">The IRC Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Panda3D</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Panda3D Tools</a> &raquo;</li>
      
    <li>Interrogate</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tools/interrogate.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="interrogate">
<span id="id1"></span><h1>Interrogate<a class="headerlink" href="#interrogate" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>Interrogate<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Interrogate is a program to parse a body of C++ code and build up a table of
classes, methods, functions, and symbols found, for the purposes of calling
into the codebase via a non-C++ scripting language like Python (Scheme and
Smalltalk were also tried at some point) The design of interrogate is such
that it should be able to produce wrappers for any other language without too
much trouble. You&#8217;ll have to be responsible for writing and maintaining the
interface layer to produce the wrappers, though.</p>
<p>In addition to identifying all the classes and their relationships,
interrogate will generate a wrapper function for each callable function. The
wrapper functions will be callable directly from the scripting language, with
no understanding of C++ necessary; these wrapper functions will in turn call
the actual C++ functions or methods.</p>
</div>
<div class="section" id="c-parser">
<h2>C++ Parser<a class="headerlink" href="#c-parser" title="Permalink to this headline">¶</a></h2>
<p>Interrogate contains a capable C++ parser supporting most most exportable
features of C++, including templates, default parameters, and function
overloading. Various C++11 features are supported as well.</p>
<p>It also extends the C++ language with various keywords that have special
meaning to Interrogate. These are used to define which interfaces are
published, and some can be used to tell Interrogate to generate additional
interfaces for the scripting language, such as properties and getters
returning a list.</p>
<p>For Interrogate to generate bindings for a particular class, one of the
following conditions needs to hold true:</p>
<ul class="simple">
<li>It has one or more methods marked with
<code class="docutils literal"><span class="pre">__published</span></code> access.</li>
<li>The <code class="docutils literal"><span class="pre">-promiscuous</span></code> option is passed
to Interrogate.</li>
<li>It is specified by a <code class="docutils literal"><span class="pre">forcetype</span></code>
directive in a special .N file.</li>
</ul>
<p>The first method is the most common approach. It is conventional to define a
<code class="docutils literal"><span class="pre">PUBLISHED</span></code> macro that will expand
to <code class="docutils literal"><span class="pre">public</span></code> when compiling the
C++ code and <code class="docutils literal"><span class="pre">__published</span></code> macro when
parsing the source with Interrogate, as follows:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// dtoolbase.h defines the PUBLISHED macro if the CPPPARSER macro is defined</span>
<span class="cp">#include</span> <span class="cpf">&quot;dtoolbase.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MyBufferClass</span> <span class="p">{</span>
<span class="nl">PUBLISHED</span><span class="p">:</span>
  <span class="c1">// This method is publicly accessible to Python and C++</span>
  <span class="kt">void</span> <span class="n">set_data</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">str</span><span class="p">);</span>

<span class="k">public</span><span class="o">:</span>
  <span class="c1">// C++-only method</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">get_buffer</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="section" id="parser-includes">
<h3>Parser Includes<a class="headerlink" href="#parser-includes" title="Permalink to this headline">¶</a></h3>
<p>Sometimes, a project may use a header file that Interrogate has difficulty
parsing. In many cases, this is simply due to Interrogate not having been
configured correctly, but it is nevertheless easier to tell Interrogate to
skip these external headers.</p>
<p>This is especially true for many standard library headers, which provide many
interfaces that Interrogate will not need, and often contain a lot of compiler
magic that Interrogate has trouble understanding.</p>
<p>In these situations, the easiest approach is to place a header in a
<em>parser-inc</em> directory, which is passed to Interrogate using the
<code class="docutils literal"><span class="pre">-s</span></code> option. This causes
Interrogate to read these mock header files instead of the actual versions,
and pick up the declarations therein.</p>
<p>This header file may be empty if the code does not need to use any of the
interfaces defined therein, or may contain some simple forward declarations
and typedefs so that Interrogate knows of the existence of these external
interfaces, even though it doesn&#8217;t need to do anything with them.</p>
<p>The Panda3D SDK provides a parser-inc directory that for many standard headers
and definitions, as well as headers for the various thirdparty libraries that
Panda3D relies on. However, it is always possible to create a custom
parser-inc directory and add it to interrogate with the
<code class="docutils literal"><span class="pre">-S</span></code> option.</p>
</div>
</div>
<div class="section" id="creating-python-bindings">
<h2>Creating Python bindings<a class="headerlink" href="#creating-python-bindings" title="Permalink to this headline">¶</a></h2>
<p>There are a few steps involved in generating Python wrappers using
interrogate.</p>
<ul class="simple">
<li>Run interrogate to parse the header files, which will generate a C++ source
file and an .in file:</li>
</ul>
<p><code class="docutils literal"><span class="pre">interrogate</span> <span class="pre">-module</span> <span class="pre">test</span> <span class="pre">-oc</span> <span class="pre">test_igate.cxx</span> <span class="pre">-od</span> <span class="pre">test.in</span> <span class="pre">-python-native</span> <span class="pre">test.h</span></code></p>
<ul class="simple">
<li>Most likely, you want to specify more flags to the interrogate command,
like -string, -fnames, -refcount, or -assert. Consult the interrogate help
file for more information about that (run interrogate with -h option)</li>
<li>Now, you will need to call interrogate_module and generate an
interrogate_module.cxx file based on your two files from the previous
step:</li>
</ul>
<p><code class="docutils literal"><span class="pre">interrogate_module</span> <span class="pre">-module</span> <span class="pre">test</span> <span class="pre">-oc</span> <span class="pre">test_module.cxx</span> <span class="pre">-python-native</span> <span class="pre">test.in</span></code></p>
<ul class="simple">
<li>Note that you can also run interrogate with the -do-module option which
will automatically make sure interrogate_module gets called too. However,
this is the disadvantage that you cannot combine the result of multiple
interrogate runs into a single module.</li>
<li>Compile and link these C++ files together into a dynamic library. Instead
of giving it the .dll extension, give it the .pyd extension, which will
make it directly importable from Python. Note that the name of the library
must be the same as the one passed to the
<code class="docutils literal"><span class="pre">-module</span></code> option.</li>
<li>You can now put it on your Python path (or make sure it&#8217;s in the same
directory) and import it directly by the name of your library:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">TestClass</span>
</pre></div>
</div>
<p>If you get this error message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">dynamic</span> <span class="n">module</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">define</span> <span class="n">init</span> <span class="n">function</span> <span class="p">(</span><span class="n">inittest</span><span class="p">)</span>
</pre></div>
</div>
<p>One of three things
could have gone wrong: you did not pass the
<code class="docutils literal"><span class="pre">-python-native</span></code> option to both the
interrogate and the interrogate_module steps, you did not link the C++ file
generated by interrogate_module into the .pyd module, or you did not pass the
correct <code class="docutils literal"><span class="pre">-module</span> <span class="pre">test</span></code> option to
interrogate and interrogate_module that matches the basename of the .pyd
file.</p>
</div>
<div class="section" id="interrogate-options">
<h2>Interrogate Options<a class="headerlink" href="#interrogate-options" title="Permalink to this headline">¶</a></h2>
<p>This section will explain how to call interrogate and will briefly address the
most important options. For the full documentation, however, refer to the
interrogate help file (accessible by calling interrogate with the -h option).</p>
<p>When calling interrogate, you will need to include the -oc and -od options,
which specify where the generated code and function tables, respectively, will
be written.</p>
<p>The -module and -library options are used to specify the name of your module
and library. These options are mainly code-organizational. You can omit both
options.</p>
<p>With -D you can ignore or make interrogate interpret symbols differently. For
example, if your code uses a non-standard C macro like __inline, you would
need to call interrogate with -D__inline. Or, if you would like certain
defines to be defined differently, you can use -Ddefvar=value.</p>
<p>Furthermore, there are a few special flags that you most likely want to
include. There is the -string option, which treats the C++ char* and STL
strings as special cases, and maps them to the scripting language&#8217;s string
equivalent, instead of a wrapper to basic_string&lt;char&gt;. The option
-refcount makes the wrappers compatible with Panda3D&#8217;s smart reference
counting system, if your library depends on Panda3D you will want to include
it too. The -assert option is just used for Python wrappers and specifies that
when the C++ code throws an assert, this will be translated to an
AssertionError exception in python.</p>
<div class="section" id="interface-makers">
<h3>Interface Makers<a class="headerlink" href="#interface-makers" title="Permalink to this headline">¶</a></h3>
<p>Interrogate provides a selection of several interface makers:</p>
<ul class="simple">
<li>The -c option will generate function wrappers using the C calling
convention. Any scripting language that can call a C function should be
able to make advantage of the interrogate database.</li>
<li>The -python option will generate function wrappers using the Python calling
convention. In this case, the shared library will directly be loadable as
python module (after interrogate_module is called), although C++ objects
and methods will be converted into an object handle and a list of
independent Python functions.</li>
<li>The -python-native option generates true python objects for C++ objects,
and translates all C++ methods to true Python methods. This is the option
you will most likely want to use.</li>
</ul>
<p>You can also specify a combination of any of those. If all are omitted, the
default is -c.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Here&#8217;s a small example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">interrogate</span> <span class="o">-</span><span class="n">DCPPPARSER</span> <span class="o">-</span><span class="n">D__STDC__</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">D__cplusplus</span><span class="o">=</span><span class="mi">201103</span><span class="n">L</span> <span class="o">-</span><span class="n">S</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">panda3d</span><span class="o">/</span><span class="n">parser</span><span class="o">-</span><span class="n">inc</span> <span class="o">-</span><span class="n">S</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">panda3d</span><span class="o">/</span>
<span class="o">-</span><span class="n">oc</span> <span class="n">myModule_igate</span><span class="o">.</span><span class="n">cxx</span> <span class="o">-</span><span class="n">od</span> <span class="n">myModule</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">fnames</span> <span class="o">-</span><span class="n">string</span> <span class="o">-</span><span class="n">refcount</span> <span class="o">-</span><span class="k">assert</span> <span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">native</span>
<span class="o">-</span><span class="n">module</span> <span class="n">libMyModule</span> <span class="o">-</span><span class="n">library</span> <span class="n">libMyModule</span> <span class="n">myModule</span><span class="o">.</span><span class="n">h</span>

<span class="n">interrogate_module</span> <span class="o">-</span><span class="n">oc</span> <span class="n">myModule_module</span><span class="o">.</span><span class="n">cxx</span> <span class="o">-</span><span class="n">module</span> <span class="n">libMyModule</span>
<span class="o">-</span><span class="n">library</span> <span class="n">libMyModule</span> <span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">native</span> <span class="n">myModule</span><span class="o">.</span><span class="ow">in</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="more-information">
<h2>More Information<a class="headerlink" href="#more-information" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>You can run the interrogate commands with the -h option to get a more
detailed explanation of the options available.</li>
<li>There is a sample C++ extension in the skel/ directory in the Panda3D
source to use as reference and sandbox.</li>
<li>David Rose, from Walt Disney VR Studio, has held a lecture about
interrogate. You can watch a video recording of it
<a class="reference external" href="https://www.youtube.com/watch?v=rh8X5pImzrI">here</a>. (Recorded June 4,
2008)</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pipeline-tips.html" class="btn btn-neutral float-right" title="Pipeline Tips" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="the-scene-graph-browser/enhanced-mouse-navigation.html" class="btn btn-neutral" title="Enhanced Mouse Navigation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Panda3D.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.10.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>